using System;
using System.Collections.Generic;
using System.Text.RegularExpressions;
using System.Windows.Forms;

namespace ServiceOrderApp
{
    public partial class Form1 : Form
    {
        private List<Order> orders = new List<Order>(); // Масив збережених замовлень

        public Form1()
        {
            InitializeComponent();

            // Додаємо приклади послуг
            comboBoxService.Items.AddRange(new string[]
            {
                "Чистка одягу", "Ремонт взуття", "Встановлення техніки"
            });

            buttonSave.Enabled = false;

            // Підписка на події для перевірки форми
            textBoxName.TextChanged += ValidateForm;
            textBoxPhone.TextChanged += ValidateForm;
            textBoxAddress.TextChanged += ValidateForm;
            comboBoxService.SelectedIndexChanged += ValidateForm;
        }

        private void ValidateForm(object sender, EventArgs e)
        {
            bool valid = !string.IsNullOrWhiteSpace(textBoxName.Text) &&
                         !string.IsNullOrWhiteSpace(textBoxAddress.Text) &&
                         !string.IsNullOrWhiteSpace(textBoxPhone.Text) &&
                         comboBoxService.SelectedIndex >= 0 &&
                         Regex.IsMatch(textBoxPhone.Text, @"^\+380\d{9}$");

            buttonSave.Enabled = valid;

            // Відображення помилок
            errorProvider1.SetError(textBoxPhone,
                Regex.IsMatch(textBoxPhone.Text, @"^\+380\d{9}$") ? "" : "Телефон має бути у форматі +380XXXXXXXXX");
        }

        private void buttonSave_Click(object sender, EventArgs e)
        {
            // Створюємо нове замовлення
            Order order = new Order
            {
                Service = comboBoxService.SelectedItem.ToString(),
                Description = textBoxDescription.Text,
                Address = textBoxAddress.Text,
                DateTime = dateTimePicker1.Value,
                ClientName = textBoxName.Text,
                Phone = textBoxPhone.Text
            };

            orders.Add(order); // Зберігаємо у масив

            // Очистка форми
            comboBoxService.SelectedIndex = -1;
            textBoxDescription.Clear();
            textBoxAddress.Clear();
            textBoxName.Clear();
            textBoxPhone.Clear();
            buttonSave.Enabled = false;

            // Вивід у Debug Console
            Console.WriteLine("=== Замовлення додано ===");
            Console.WriteLine($"Послуга: {order.Service}");
            Console.WriteLine($"Опис: {order.Description}");
            Console.WriteLine($"Адреса: {order.Address}");
            Console.WriteLine($"Дата: {order.DateTime}");
            Console.WriteLine($"Клієнт: {order.ClientName}");
            Console.WriteLine($"Телефон: {order.Phone}");
            Console.WriteLine("========================");
        }
    }
}